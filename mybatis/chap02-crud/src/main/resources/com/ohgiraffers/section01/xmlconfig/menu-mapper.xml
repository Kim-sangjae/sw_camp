<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MenuMapper">

<!--   조회한 컬럼과 자바 객체의 필드를 매핑시키기 위한 설정        -->
    <resultMap id="menuResultMap" type="com.ohgiraffers.section01.xmlconfig.MenuDTO">

        <!-- id : pk에 해당하는 컬럼을 작성 -->
        <id property="menuCode" column="menu_code"/>

        <!-- result : pk 이외의 일반 컬럼을 작성 -->
        <result property="menuName" column="menu_name"/>
        <result property="menuPrice" column="menu_price"/>
        <result property="categoryCode" column="category_code"/>
        <result property="orderableStatus" column="orderable_status"/>


    </resultMap>

    <select id="selectAllMenu" resultMap="menuResultMap">
        select
            menu_code,
            menu_name,
            menu_price,
            category_code,
            orderable_status
        from tbl_menu
        order by menu_code
    </select>


<!--    전달 죄는 파라미터가 기본 자료형인 경우 #{} 내부 명칭은 어떤값을 작성해도 무관
        단 ,객체 자료형인 #{} 내부 명칭은 필드명과 일치시켜야한다  -->
    <select id="selectMenuByMenuCode" resultMap="menuResultMap">
        select
            menu_code,
            menu_name,
            menu_price,
            category_code,
            orderable_status
        from tbl_menu
        where menu_code = #{menuCode}
    </select>


    <!--
        id : 필수
        resultMap or resultType 은 조회시에만 필요하며
        DML 구문 실행시에는 수행 된 행의 개수가 기본적으로 반환된다.
        parameterType : optional(필수는아님)
        자주 사용하는 타입이 있다면 configuration에서 별칭을 등록해서 사용 가능
        별칭을 등록하지 않으면 정확한 패키지명을 포함하는 풀네임을 작성해야 한다.
    -->
    <insert id="insertMenu" parameterType="MenuDTO">
        insert into
            tbl_menu (menu_name, menu_price , category_code , orderable_status)
        values (#{menuName}, #{menuPrice}, #{categoryCode}, 'Y')
    </insert>


    <update id="updateMenu" parameterType="MenuDTO">
        update tbl_menu
        set
        menu_name = #{menuName},
        menu_price = #{menuPrice},
        category_code = #{categoryCode},
        orderable_status = 'Y'
        where
        menu_code = #{menuCode}
    </update>

    <!-- _int 와 같은 파라미터타입의 별칭들은 mybatis에서 기본적으로 정해놓은 별칭의 이름이다 (mybatis 홈페이지 참조)-->
    <delete id="deleteMenu" parameterType="_int">
        delete from tbl_menu
        where
        menu_code = #{menuCode}
    </delete>
</mapper>